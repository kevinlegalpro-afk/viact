<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facilitraining Rainbow Explorer</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (pour compiler le JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Styles globaux -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Animations simples pour l'apparition initiale seulement */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICÔNES (SVG Components) ---
        const Icon = ({ path, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        const MonitorPlay = (props) => <Icon {...props} path={<><path d="m10 7 5 3-5 3Z"/><rect width="20" height="14" x="2" y="3" rx="2"/><path d="M12 17v4"/><path d="M8 21h8"/></>} />;
        const Eye = (props) => <Icon {...props} path={<><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></>} />;
        const BookOpen = (props) => <Icon {...props} path={<><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></>} />;
        const HelpCircle = (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></>} />;
        const MessageCircle = (props) => <Icon {...props} path={<><path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"/></>} />;
        const Lightbulb = (props) => <Icon {...props} path={<><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></>} />;
        const ShieldCheck = (props) => <Icon {...props} path={<><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></>} />;
        const ArrowRight = (props) => <Icon {...props} path={<><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></>} />;
        const RefreshCcw = (props) => <Icon {...props} path={<><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></>} />;
        const Trophy = (props) => <Icon {...props} path={<><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></>} />;
        const Info = (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></>} />;
        const Sparkles = (props) => <Icon {...props} path={<><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 3v4"/><path d="M3 5h4"/><path d="M3 9h4"/></>} />;
        const Target = (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></>} />;
        const Quote = (props) => <Icon {...props} path={<><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/></>} />;
        const Users = (props) => <Icon {...props} path={<><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></>} />;
        const Globe = (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></>} />;

        // --- COMPOSANT PRINCIPAL ---
        const FacilitrainingExplorer = () => {
            const [activeTab, setActiveTab] = useState('explore');
            const [sliderValue, setSliderValue] = useState(50);
            const [currentRole, setCurrentRole] = useState(null);
            const [isDragging, setIsDragging] = useState(false);
            const [lang, setLang] = useState('fr'); // 'fr' or 'en'
            const svgRef = useRef(null);

            // --- TRADUCTIONS & DONNÉES ---
            const content = {
                fr: {
                    header: {
                        badge: "Modèle Officiel (Townsend & Donovan)",
                        titleStart: "Facili",
                        titleEnd: "training",
                        subtitle: <React.Fragment>Les 7 nuances de l'intervention : du <span className="font-bold text-slate-700">Contenu</span> vers le <span className="font-bold text-slate-700">Processus</span>.</React.Fragment>
                    },
                    tabs: {
                        explore: "Explorer l'Arc (7 Postures)",
                        challenge: "Mode Défi"
                    },
                    arcLabels: {
                        start: "Contenu",
                        end: "Processus"
                    },
                    labels: {
                        action: "Action",
                        behaviors: "Comportements",
                        when: "Quand l'utiliser ?",
                        contributionTitle: "Contribution",
                        contributionSub: "(Apport de contenu de la part de l'intervenant)",
                        interactionTitle: "Interaction",
                        interactionSub: "(Interaction avec les apprenants)",
                        level: "Niveau :",
                        score: "Score Final :",
                        next: "Suivant",
                        restart: "Recommencer",
                        correct: "Exactement !",
                        incorrect: "Pas tout à fait...",
                        footer: "Basé sur le modèle \"Facilitraining Rainbow\" de John Townsend & Paul Donovan (The Facilitator's Pocketbook)."
                    },
                    roles: [
                        {
                            id: 'presenting',
                            title: 'Présentation',
                            subtitle: 'Le Conférencier',
                            range: [0, 14],
                            colorCls: 'text-red-600',
                            bgCls: 'bg-red-50',
                            borderCls: 'border-red-200',
                            gradient: 'from-red-500 to-red-400',
                            icon: <MonitorPlay className="w-12 h-12" />,
                            axes: { interaction: 'Faible', contribution: 'Forte' },
                            contribDesc: "Vous êtes la source unique d'information.",
                            interDesc: "Le groupe écoute passivement.",
                            action: 'TRANSMET',
                            desc: "Le style classique pour transmettre de l'information. Vous détenez le savoir et le donnez au groupe.",
                            behaviors: ["Exposés magistraux", "Diapositives (PowerPoint)", "Discours inspirant", "Pas ou peu d'interruption"],
                            when: "Nécessaire pour poser des bases, donner des consignes de sécurité ou introduire un sujet totalement nouveau."
                        },
                        {
                            id: 'demonstrating',
                            title: 'Démonstration',
                            subtitle: 'Le Démonstrateur',
                            range: [15, 28],
                            colorCls: 'text-orange-600',
                            bgCls: 'bg-orange-50',
                            borderCls: 'border-orange-200',
                            gradient: 'from-orange-500 to-amber-500',
                            icon: <Eye className="w-12 h-12" />,
                            axes: { interaction: 'Faible/Moyenne', contribution: 'Forte' },
                            contribDesc: "Vous montrez l'exemple à suivre.",
                            interDesc: "Le groupe observe et reproduit.",
                            action: 'MONTRE',
                            desc: "Vous montrez 'comment faire'. Ce n'est pas uniquement théorique, vous modélisez le comportement ou la technique attendue.",
                            behaviors: ["\"Regardez-moi faire\"", "Utilisation d'outils en temps réel", "Jeux de rôle (modèle)", "Visualisation"],
                            when: "Pour l'apprentissage d'un geste technique, d'un logiciel ou d'une procédure spécifique."
                        },
                        {
                            id: 'teaching',
                            title: 'Enseignement',
                            subtitle: 'L\'Instituteur',
                            range: [29, 42],
                            colorCls: 'text-yellow-600',
                            bgCls: 'bg-yellow-50',
                            borderCls: 'border-yellow-200',
                            gradient: 'from-yellow-500 to-yellow-400',
                            icon: <BookOpen className="w-12 h-12" />,
                            axes: { interaction: 'Moyenne', contribution: 'Moyenne/Forte' },
                            contribDesc: "Vous structurez le savoir à acquérir.",
                            interDesc: "Le groupe répond à vos sollicitations.",
                            action: 'STRUCTURE',
                            desc: "Vous créez des expériences d'apprentissage structurées. Vous guidez vers des objectifs précis tout en laissant une petite marge d'interprétation.",
                            behaviors: ["Exercices guidés", "Q&A (Questions/Réponses)", "Études de cas dirigées", "Feedback correctif"],
                            when: "Pour vérifier la compréhension et ancrer des connaissances théoriques dans la pratique."
                        },
                        {
                            id: 'socratic',
                            title: 'Direction Socratique',
                            subtitle: 'Le Maïeuticien',
                            range: [43, 57],
                            colorCls: 'text-green-600',
                            bgCls: 'bg-green-50',
                            borderCls: 'border-green-200',
                            gradient: 'from-green-500 to-emerald-500',
                            icon: <HelpCircle className="w-12 h-12" />,
                            axes: { interaction: 'Forte', contribution: 'Variable' },
                            contribDesc: "Vous possédez la réponse, mais ils la trouvent.",
                            interDesc: "Le groupe réfléchit intensément.",
                            action: 'GUIDE (QUESTIONNE)',
                            desc: "Vous savez où vous voulez les emmener, mais vous utilisez des questions pour qu'ils trouvent la réponse eux-mêmes (\"Les gens ne discutent pas leurs propres données\").",
                            behaviors: ["Questions orientées", "Reformulation stratégique", "Faire émerger la réponse", "Facipulation (bienveillante)"],
                            when: "Pour faire adhérer le groupe à une conclusion logique ou vérifier l'acquisition profonde d'un concept."
                        },
                        {
                            id: 'discussion',
                            title: 'Facilitation de Discussion',
                            subtitle: 'L\'Animateur',
                            range: [58, 71],
                            colorCls: 'text-teal-600',
                            bgCls: 'bg-teal-50',
                            borderCls: 'border-teal-200',
                            gradient: 'from-teal-500 to-cyan-500',
                            icon: <MessageCircle className="w-12 h-12" />,
                            axes: { interaction: 'Forte', contribution: 'Faible/Moyenne' },
                            contribDesc: "Vous injectez peu de contenu, juste des relances.",
                            interDesc: "Le groupe échange librement.",
                            action: 'ANIMER',
                            desc: "Vous gérez les échanges. Vous pouvez donner votre opinion ou provoquer, mais surtout pour stimuler le débat, pas pour imposer la vérité.",
                            behaviors: ["Distribuer la parole", "Relancer les silencieux", "Avocat du diable", "Synthétiser les points de vue"],
                            when: "Pour échanger des bonnes pratiques, débattre d'un sujet complexe ou partager des expériences (Rétrospective)."
                        },
                        {
                            id: 'brainstorming',
                            title: 'Brainstorming',
                            subtitle: 'Le Catalyseur',
                            range: [72, 85],
                            colorCls: 'text-blue-600',
                            bgCls: 'bg-blue-50',
                            borderCls: 'border-blue-200',
                            gradient: 'from-cyan-500 to-blue-500',
                            icon: <Lightbulb className="w-12 h-12" />,
                            axes: { interaction: 'Moyenne', contribution: 'Faible' },
                            contribDesc: "Vous ne jugez rien, vous notez tout.",
                            interDesc: "Le groupe produit du contenu en masse.",
                            action: 'ENCOURAGE',
                            desc: "Vous stimulez la production d'idées sans jamais les évaluer. Vous êtes là pour la quantité et la créativité, pas la qualité immédiate.",
                            behaviors: ["Noter les idées au tableau", "Encourager le 'OUI, ET...'", "Interdire la critique", "Techniques de créativité"],
                            when: "Recherche de solutions innovantes, divergence, début de projet."
                        },
                        {
                            id: 'process',
                            title: 'Process Monitoring',
                            subtitle: 'Le Gardien',
                            range: [86, 100],
                            colorCls: 'text-violet-600',
                            bgCls: 'bg-violet-50',
                            borderCls: 'border-violet-200',
                            gradient: 'from-blue-600 to-violet-600',
                            icon: <ShieldCheck className="w-12 h-12" />,
                            axes: { interaction: 'Low', contribution: 'None (Content)' },
                            contribDesc: "Aucun apport de fond. Zéro.",
                            interDesc: "Le groupe est en autonomie totale.",
                            action: 'OBSERVE',
                            desc: "Le Facilitateur pur. Vous ne contribuez PAS au contenu. Vous êtes uniquement garant des règles du jeu et du temps.",
                            behaviors: ["Observation silencieuse", "Rappel du Time-boxing", "Garantir la sécurité psychologique", "Intervention uniquement sur la forme"],
                            when: "Lorsque le groupe est mature et autonome, ou lors d'une prise de décision finale où votre neutralité doit être totale."
                        }
                    ],
                    scenarios: [
                        {
                            text: "Le groupe doit générer un maximum d'idées pour le nom du nouveau produit. Aucune censure autorisée.",
                            correct: 'brainstorming',
                            explanation: "C'est la définition même du Brainstorming : quantité d'idées, pas de jugement, le facilitateur note tout (Scripte) sans filtrer."
                        },
                        {
                            text: "Vous voulez faire comprendre au groupe pourquoi leur processus actuel échoue, en leur posant une série de questions ciblées.",
                            correct: 'socratic',
                            explanation: "C'est la Direction Socratique. Vous connaissez la réponse (le processus échoue), mais vous les guidez par des questions pour qu'ils le réalisent eux-mêmes."
                        },
                        {
                            text: "L'équipe est en plein conflit ouvert lors d'une prise de décision. Vous intervenez juste pour rappeler la règle : 'On ne coupe pas la parole'.",
                            correct: 'process',
                            explanation: "C'est du Monitoring de Processus pur. Vous n'intervenez pas sur le fond du conflit, uniquement sur le respect des règles (le cadre)."
                        },
                        {
                            text: "Vous devez expliquer les 3 piliers de la sécurité incendie à tous les nouveaux arrivants.",
                            correct: 'presenting',
                            explanation: "C'est de la Présentation. L'information est descendante, non négociable et le groupe est novice sur le sujet."
                        },
                        {
                            text: "Un stagiaire ne sait pas utiliser la machine à café. Vous lui dites : 'Regarde comment je fais', et vous préparez un café devant lui.",
                            correct: 'demonstrating',
                            explanation: "C'est de la Démonstration. Vous montrez l'exemple par l'action pour qu'il puisse imiter le geste."
                        }
                    ]
                },
                en: {
                    header: {
                        badge: "Official Model (Townsend & Donovan)",
                        titleStart: "Facili",
                        titleEnd: "training",
                        subtitle: <React.Fragment>The 7 shades of intervention: from <span className="font-bold text-slate-700">Content</span> to <span className="font-bold text-slate-700">Process</span>.</React.Fragment>
                    },
                    tabs: {
                        explore: "Explore the Arc (7 Roles)",
                        challenge: "Challenge Mode"
                    },
                    arcLabels: {
                        start: "Content",
                        end: "Process"
                    },
                    labels: {
                        action: "Action",
                        behaviors: "Behaviors",
                        when: "When to use?",
                        contributionTitle: "Contribution",
                        contributionSub: "(Content input from the trainer)",
                        interactionTitle: "Interaction",
                        interactionSub: "(Interaction with learners)",
                        level: "Level:",
                        score: "Final Score:",
                        next: "Next",
                        restart: "Restart",
                        correct: "Exactly!",
                        incorrect: "Not exactly...",
                        footer: "Based on the \"Facilitraining Rainbow\" model by John Townsend & Paul Donovan (The Facilitator's Pocketbook)."
                    },
                    roles: [
                        {
                            id: 'presenting',
                            title: 'Presenting',
                            subtitle: 'The Lecturer',
                            range: [0, 14],
                            colorCls: 'text-red-600',
                            bgCls: 'bg-red-50',
                            borderCls: 'border-red-200',
                            gradient: 'from-red-500 to-red-400',
                            icon: <MonitorPlay className="w-12 h-12" />,
                            axes: { interaction: 'Low', contribution: 'High' },
                            contribDesc: "You are the sole source of information.",
                            interDesc: "The group listens passively.",
                            action: 'TELL',
                            desc: "The classic style for transmitting information. You hold the knowledge and give it to the group.",
                            behaviors: ["Lectures", "Slides (PowerPoint)", "Inspirational speech", "Little or no interruption"],
                            when: "Necessary to lay foundations, give safety instructions, or introduce a totally new subject."
                        },
                        {
                            id: 'demonstrating',
                            title: 'Demonstrating',
                            subtitle: 'The Demonstrator',
                            range: [15, 28],
                            colorCls: 'text-orange-600',
                            bgCls: 'bg-orange-50',
                            borderCls: 'border-orange-200',
                            gradient: 'from-orange-500 to-amber-500',
                            icon: <Eye className="w-12 h-12" />,
                            axes: { interaction: 'Low/Medium', contribution: 'High' },
                            contribDesc: "You show the example to follow.",
                            interDesc: "The group observes and replicates.",
                            action: 'SHOW',
                            desc: "You show 'how to do it'. It's not just theoretical, you model the expected behavior or technique.",
                            behaviors: ["\"Watch me do it\"", "Real-time tool usage", "Role play (modeling)", "Visualization"],
                            when: "For learning a technical skill, software, or specific procedure."
                        },
                        {
                            id: 'teaching',
                            title: 'Teaching',
                            subtitle: 'The Teacher',
                            range: [29, 42],
                            colorCls: 'text-yellow-600',
                            bgCls: 'bg-yellow-50',
                            borderCls: 'border-yellow-200',
                            gradient: 'from-yellow-500 to-yellow-400',
                            icon: <BookOpen className="w-12 h-12" />,
                            axes: { interaction: 'Medium', contribution: 'Medium/High' },
                            contribDesc: "You structure the knowledge to be acquired.",
                            interDesc: "The group responds to your prompts.",
                            action: 'STRUCTURE',
                            desc: "You create structured learning experiences. You guide towards specific goals while leaving a small margin for interpretation.",
                            behaviors: ["Guided exercises", "Q&A sessions", "Directed case studies", "Corrective feedback"],
                            when: "To check understanding and anchor theoretical knowledge in practice."
                        },
                        {
                            id: 'socratic',
                            title: 'Socratic Direction',
                            subtitle: 'The Maieutician',
                            range: [43, 57],
                            colorCls: 'text-green-600',
                            bgCls: 'bg-green-50',
                            borderCls: 'border-green-200',
                            gradient: 'from-green-500 to-emerald-500',
                            icon: <HelpCircle className="w-12 h-12" />,
                            axes: { interaction: 'High', contribution: 'Variable' },
                            contribDesc: "You have the answer, but they find it.",
                            interDesc: "The group thinks intensively.",
                            action: 'GUIDE (ASK)',
                            desc: "You know where you want to take them, but you use questions so they find the answer themselves (\"People don't argue with their own data\").",
                            behaviors: ["Leading questions", "Strategic reformulation", "Emerging the answer", "Benevolent manipulation"],
                            when: "To get group buy-in on a logical conclusion or check deep acquisition of a concept."
                        },
                        {
                            id: 'discussion',
                            title: 'Discussion Facilitation',
                            subtitle: 'The Animator',
                            range: [58, 71],
                            colorCls: 'text-teal-600',
                            bgCls: 'bg-teal-50',
                            borderCls: 'border-teal-200',
                            gradient: 'from-teal-500 to-cyan-500',
                            icon: <MessageCircle className="w-12 h-12" />,
                            axes: { interaction: 'High', contribution: 'Low/Medium' },
                            contribDesc: "You inject little content, just prompts.",
                            interDesc: "The group exchanges freely.",
                            action: 'ANIMATE',
                            desc: "You manage the exchanges. You can give your opinion or provoke, but mainly to stimulate debate, not to impose the truth.",
                            behaviors: ["Distributing speech", "Engaging silent members", "Devil's advocate", "Synthesizing viewpoints"],
                            when: "To exchange best practices, debate a complex topic, or share experiences (Retrospective)."
                        },
                        {
                            id: 'brainstorming',
                            title: 'Brainstorming',
                            subtitle: 'The Catalyst',
                            range: [72, 85],
                            colorCls: 'text-blue-600',
                            bgCls: 'bg-blue-50',
                            borderCls: 'border-blue-200',
                            gradient: 'from-cyan-500 to-blue-500',
                            icon: <Lightbulb className="w-12 h-12" />,
                            axes: { interaction: 'Medium', contribution: 'Low' },
                            contribDesc: "You judge nothing, you note everything.",
                            interDesc: "The group produces content en masse.",
                            action: 'ENCOURAGE',
                            desc: "You stimulate idea generation without ever evaluating them. You are there for quantity and creativity, not immediate quality.",
                            behaviors: ["Scribing ideas on board", "Encouraging 'YES, AND...'", "Forbidding criticism", "Creativity techniques"],
                            when: "Searching for innovative solutions, divergence, project kickoff."
                        },
                        {
                            id: 'process',
                            title: 'Process Monitoring',
                            subtitle: 'The Guardian',
                            range: [86, 100],
                            colorCls: 'text-violet-600',
                            bgCls: 'bg-violet-50',
                            borderCls: 'border-violet-200',
                            gradient: 'from-blue-600 to-violet-600',
                            icon: <ShieldCheck className="w-12 h-12" />,
                            axes: { interaction: 'Low', contribution: 'None (Content)' },
                            contribDesc: "No content input. Zero.",
                            interDesc: "The group is in total autonomy.",
                            action: 'OBSERVE',
                            desc: "The pure Facilitator. You do NOT contribute to content. You are solely the guardian of the rules and time.",
                            behaviors: ["Silent observation", "Time-boxing reminders", "Ensuring psychological safety", "Intervention only on process"],
                            when: "When the group is mature and autonomous, or during a final decision where your neutrality must be absolute."
                        }
                    ],
                    scenarios: [
                        {
                            text: "The group needs to generate a maximum of ideas for the new product name. No censorship allowed.",
                            correct: 'brainstorming',
                            explanation: "This is the very definition of Brainstorming: quantity of ideas, no judgment, the facilitator notes everything (Scribing) without filtering."
                        },
                        {
                            text: "You want the group to understand why their current process is failing by asking a series of targeted questions.",
                            correct: 'socratic',
                            explanation: "This is Socratic Direction. You know the answer (the process is failing), but you guide them with questions so they realize it themselves."
                        },
                        {
                            text: "The team is in open conflict during a decision-making process. You intervene just to remind them of the rule: 'Do not interrupt'.",
                            correct: 'process',
                            explanation: "This is pure Process Monitoring. You do not intervene on the content of the conflict, only on compliance with the rules (the framework)."
                        },
                        {
                            text: "You must explain the 3 pillars of fire safety to all new arrivals.",
                            correct: 'presenting',
                            explanation: "This is Presenting. The information is top-down, non-negotiable, and the group is novice on the subject."
                        },
                        {
                            text: "A trainee doesn't know how to use the coffee machine. You say: 'Watch how I do it', and make a coffee in front of them.",
                            correct: 'demonstrating',
                            explanation: "This is Demonstrating. You show the example through action so they can imitate the gesture."
                        }
                    ]
                }
            };

            const currentContent = content[lang];
            const roles = currentContent.roles;
            const scenarios = currentContent.scenarios;

            useEffect(() => {
                const role = roles.find(r => sliderValue >= r.range[0] && sliderValue <= r.range[1]);
                if (role && (role.id !== currentRole?.id || lang)) { // Re-run if role changes OR lang changes
                    setCurrentRole(role);
                }
            }, [sliderValue, lang, roles, currentRole]);

            // --- ARC INTERACTION LOGIC ---
            const handleArcInteraction = (e) => {
                if (!svgRef.current) return;
                
                const svgRect = svgRef.current.getBoundingClientRect();
                const centerX = svgRect.width / 2;
                const centerY = svgRect.height - 10;
                
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                
                const dx = clientX - (svgRect.left + centerX);
                const dy = clientY - (svgRect.top + centerY);
                
                let angleRad = Math.atan2(dy, dx);
                let angleDeg = angleRad * (180 / Math.PI);
                
                let value = 0;
                
                if (angleDeg >= -180 && angleDeg <= 0) {
                    const normalizedAngle = angleDeg + 180; 
                    value = (normalizedAngle / 180) * 100;
                } else if (angleDeg > 0 && angleDeg < 90) {
                    value = 100;
                } else {
                    value = 0;
                }
                
                setSliderValue(Math.min(100, Math.max(0, Math.round(value))));
            };

            const handleMouseDown = (e) => {
                setIsDragging(true);
                handleArcInteraction(e);
            };

            const handleMouseMove = (e) => {
                if (isDragging) {
                    // e.preventDefault(); // Commented out to prevent blocking some touch behaviors if needed, mostly fine
                    handleArcInteraction(e);
                }
            };

            const handleMouseUp = () => {
                setIsDragging(false);
            };

            useEffect(() => {
                if (isDragging) {
                    window.addEventListener('mousemove', handleMouseMove);
                    window.addEventListener('mouseup', handleMouseUp);
                    window.addEventListener('touchmove', handleMouseMove);
                    window.addEventListener('touchend', handleMouseUp);
                }
                return () => {
                    window.removeEventListener('mousemove', handleMouseMove);
                    window.removeEventListener('mouseup', handleMouseUp);
                    window.removeEventListener('touchmove', handleMouseMove);
                    window.removeEventListener('touchend', handleMouseUp);
                };
            }, [isDragging]);

            const radius = 140;
            const strokeWidth = 30;
            const angle = Math.PI - (sliderValue / 100) * Math.PI;
            const thumbX = radius * Math.cos(angle); 
            const thumbY = radius * -Math.sin(angle);


            // --- QUIZ LOGIC ---
            const [currentScenarioIndex, setCurrentScenarioIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [showResult, setShowResult] = useState(false);
            const [quizFinished, setQuizFinished] = useState(false);
            const [selectedAnswer, setSelectedAnswer] = useState(null);

            const handleAnswer = (roleId) => {
                setSelectedAnswer(roleId);
                setShowResult(true);
                if (roleId === scenarios[currentScenarioIndex].correct) {
                    setScore(score + 1);
                }
            };

            const nextScenario = () => {
                setShowResult(false);
                setSelectedAnswer(null);
                if (currentScenarioIndex < scenarios.length - 1) {
                    setCurrentScenarioIndex(currentScenarioIndex + 1);
                } else {
                    setQuizFinished(true);
                }
            };

            const resetQuiz = () => {
                setScore(0);
                setCurrentScenarioIndex(0);
                setQuizFinished(false);
                setShowResult(false);
                setSelectedAnswer(null);
            };

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 font-sans p-4 md:p-8 flex flex-col items-center selection:bg-blue-100 relative">
                    
                    {/* Language Switcher */}
                    <div className="absolute top-4 right-4 z-50">
                        <button 
                            onClick={() => setLang(lang === 'fr' ? 'en' : 'fr')}
                            className="flex items-center gap-2 bg-white px-4 py-2 rounded-full shadow-md border border-slate-200 hover:bg-slate-50 transition-all text-sm font-bold text-slate-700 cursor-pointer"
                        >
                            <Globe className="w-4 h-4" />
                            {lang === 'fr' ? 'EN' : 'FR'}
                        </button>
                    </div>

                    {/* Header */}
                    <header className="text-center mb-6 mt-4 relative z-10">
                        <div className="inline-block p-2 px-4 rounded-full bg-white border border-slate-200 shadow-sm text-xs font-bold tracking-widest text-slate-500 mb-4 uppercase">
                            {currentContent.header.badge}
                        </div>
                        <h1 className="text-4xl md:text-6xl font-black mb-3 tracking-tight text-slate-900">
                            {currentContent.header.titleStart}<span className="text-transparent bg-clip-text bg-gradient-to-r from-red-500 via-green-500 to-violet-500">{currentContent.header.titleEnd}</span> Rainbow
                        </h1>
                        <p className="text-slate-500 text-lg max-w-lg mx-auto leading-relaxed">
                            {currentContent.header.subtitle}
                        </p>
                    </header>

                    {/* Tabs */}
                    <div className="bg-white p-1.5 rounded-2xl shadow-lg shadow-slate-200/50 border border-slate-100 flex gap-2 mb-8 relative z-10">
                        <button
                            onClick={() => setActiveTab('explore')}
                            className={`px-6 py-2 md:px-8 md:py-3 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${
                                activeTab === 'explore' 
                                ? 'bg-slate-900 text-white shadow-md scale-100' 
                                : 'text-slate-500 hover:bg-slate-50 hover:text-slate-700'
                            }`}
                        >
                            <Sparkles className="w-4 h-4" /> {currentContent.tabs.explore}
                        </button>
                        <button
                            onClick={() => setActiveTab('challenge')}
                            className={`px-6 py-2 md:px-8 md:py-3 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${
                                activeTab === 'challenge' 
                                ? 'bg-slate-900 text-white shadow-md scale-100' 
                                : 'text-slate-500 hover:bg-slate-50 hover:text-slate-700'
                            }`}
                        >
                            <Target className="w-4 h-4" /> {currentContent.tabs.challenge}
                        </button>
                    </div>

                    {/* MAIN CONTAINER */}
                    <div className="w-full max-w-5xl bg-white rounded-[2rem] shadow-2xl shadow-slate-200/50 border border-white overflow-hidden min-h-[650px] relative z-0">
                        
                        {/* Background Gradient Line */}
                        <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-red-500 via-green-500 to-violet-500 opacity-80"></div>

                        {activeTab === 'explore' && currentRole && (
                            <div className="p-4 md:p-8 animate-in flex flex-col items-center">
                                
                                {/* ARC SVG */}
                                <div className="relative w-full max-w-lg h-[220px] mb-4 select-none flex justify-center">
                                    <svg 
                                        ref={svgRef}
                                        viewBox={`0 0 320 180`} 
                                        className="w-full h-full overflow-visible cursor-pointer touch-none"
                                        onMouseDown={handleMouseDown}
                                        onTouchStart={handleMouseDown}
                                    >
                                        <defs>
                                            <linearGradient id="rainbowGradientOfficial" x1="0%" y1="0%" x2="100%" y2="0%">
                                                <stop offset="0%" stopColor="#dc2626" /> {/* Rouge */}
                                                <stop offset="16%" stopColor="#ea580c" /> {/* Orange */}
                                                <stop offset="32%" stopColor="#ca8a04" /> {/* Jaune */}
                                                <stop offset="48%" stopColor="#16a34a" /> {/* Vert */}
                                                <stop offset="64%" stopColor="#0d9488" /> {/* Teal */}
                                                <stop offset="80%" stopColor="#2563eb" /> {/* Bleu */}
                                                <stop offset="100%" stopColor="#7c3aed" /> {/* Violet */}
                                            </linearGradient>
                                            <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                                                <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                                                <feMerge>
                                                    <feMergeNode in="coloredBlur"/>
                                                    <feMergeNode in="SourceGraphic"/>
                                                </feMerge>
                                            </filter>
                                        </defs>
                                        
                                        <path d="M 20 170 A 140 140 0 0 1 300 170" fill="none" stroke="#f1f5f9" strokeWidth={strokeWidth} strokeLinecap="round" />
                                        <path 
                                            d="M 20 170 A 140 140 0 0 1 300 170" 
                                            fill="none" 
                                            stroke="url(#rainbowGradientOfficial)" 
                                            strokeWidth={strokeWidth} 
                                            strokeLinecap="round"
                                            filter="url(#glow)"
                                            opacity="0.9"
                                        />
                                        <path d="M 10 170 A 150 150 0 0 1 310 170" fill="none" stroke="transparent" strokeWidth="60" />

                                        <g transform={`translate(${160 + thumbX}, ${170 + thumbY})`}>
                                            <circle r="12" fill="white" stroke="#0f172a" strokeWidth="4" className="shadow-xl" />
                                        </g>
                                        
                                        <text x="10" y="195" textAnchor="start" className="text-[10px] font-bold fill-slate-400 uppercase tracking-widest">{currentContent.arcLabels.start}</text>
                                        <text x="310" y="195" textAnchor="end" className="text-[10px] font-bold fill-slate-400 uppercase tracking-widest">{currentContent.arcLabels.end}</text>
                                    </svg>
                                    
                                    {/* Dashboard Central */}
                                    <div className="absolute top-[90px] left-1/2 transform -translate-x-1/2 text-center pointer-events-none w-64">
                                        <div className={`inline-flex items-center justify-center p-3 rounded-2xl shadow-lg mb-2 ${currentRole.bgCls} ${currentRole.colorCls} transition-all duration-300`}>
                                            {currentRole.icon}
                                        </div>
                                        <div className={`text-sm font-black uppercase tracking-widest ${currentRole.colorCls}`}>
                                            {currentRole.subtitle}
                                        </div>
                                    </div>
                                </div>

                                {/* Quick Links */}
                                <div className="flex flex-wrap justify-center gap-2 md:gap-4 w-full max-w-3xl mx-auto mb-8 text-[9px] md:text-[10px] font-bold text-slate-400 uppercase tracking-wider px-4">
                                    {roles.map((r) => (
                                        <button 
                                            key={r.id} 
                                            onClick={() => setSliderValue(r.range[0] + 2)}
                                            className={`hover:text-slate-900 transition-colors ${currentRole.id === r.id ? 'text-slate-900 underline decoration-2 underline-offset-4' : ''}`}
                                        >
                                            {r.title}
                                        </button>
                                    ))}
                                </div>

                                {/* Content Details */}
                                <div className="w-full">
                                    <div className="grid md:grid-cols-12 gap-8">
                                        
                                        {/* Left Col: Title & Desc */}
                                        <div className="md:col-span-7 flex flex-col">
                                            <div className="flex items-baseline gap-3 mb-2">
                                                <h2 className={`text-3xl md:text-5xl font-black text-slate-900`}>
                                                    {currentRole.title}
                                                </h2>
                                            </div>
                                            
                                            <div className={`text-base font-bold mb-6 flex items-center gap-2 ${currentRole.colorCls} uppercase tracking-wide`}>
                                                {currentContent.labels.action} : {currentRole.action}
                                            </div>

                                            <p className="text-lg text-slate-800 leading-relaxed font-medium mb-8 bg-slate-50 p-6 rounded-2xl border border-slate-100">
                                                "{currentRole.desc}"
                                            </p>
                                            
                                            {/* AXES METERS CLARIFIED - FIXED Z-INDEX */}
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-auto">
                                                
                                                {/* Meter 1: Contribution */}
                                                <div className="bg-white border border-slate-200 p-5 rounded-xl shadow-sm relative overflow-hidden group">
                                                    <div className="absolute -top-2 -right-2 p-2 opacity-5 group-hover:opacity-10 transition-opacity rotate-12 z-0">
                                                        <BookOpen className="w-20 h-20 text-slate-900" />
                                                    </div>
                                                    
                                                    <div className="relative z-10">
                                                        <span className="text-[10px] uppercase font-bold text-slate-400 block mb-1 flex items-center gap-1">
                                                            {currentContent.labels.contributionTitle} <Info className="w-3 h-3" />
                                                        </span>
                                                        <span className="text-[10px] text-slate-400 block mb-3 font-medium">
                                                            {currentContent.labels.contributionSub}
                                                        </span>
                                                        
                                                        <div className="text-xs text-slate-600 font-medium mb-3 min-h-[2.5rem] leading-snug">
                                                            {currentRole.contribDesc}
                                                        </div>
                                                        
                                                        <div className="flex justify-between items-end mb-2">
                                                            <span className="text-xs font-bold text-slate-400">{currentContent.labels.level}</span>
                                                            <div className="text-sm font-bold text-slate-800">{currentRole.axes.contribution}</div>
                                                        </div>
                                                        
                                                        <div className="h-2 w-full bg-slate-100 rounded-full overflow-hidden">
                                                            <div className={`h-full bg-slate-800 transition-all duration-500`} style={{
                                                                width: currentRole.axes.contribution.includes('Forte') || currentRole.axes.contribution.includes('High') ? '90%' : currentRole.axes.contribution.includes('Moyenne') || currentRole.axes.contribution.includes('Medium') ? '50%' : currentRole.axes.contribution.includes('Variable') ? '60%' : '10%'
                                                            }}></div>
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* Meter 2: Interaction */}
                                                <div className="bg-white border border-slate-200 p-5 rounded-xl shadow-sm relative overflow-hidden group">
                                                    <div className="absolute -top-2 -right-2 p-2 opacity-5 group-hover:opacity-10 transition-opacity rotate-12 z-0">
                                                        <Users className="w-20 h-20 text-slate-900" />
                                                    </div>
                                                    
                                                    <div className="relative z-10">
                                                        <span className="text-[10px] uppercase font-bold text-slate-400 block mb-1 flex items-center gap-1">
                                                            {currentContent.labels.interactionTitle} <Info className="w-3 h-3" />
                                                        </span>
                                                        <span className="text-[10px] text-slate-400 block mb-3 font-medium">
                                                            {currentContent.labels.interactionSub}
                                                        </span>
                                                        
                                                        <div className="text-xs text-slate-600 font-medium mb-3 min-h-[2.5rem] leading-snug">
                                                            {currentRole.interDesc}
                                                        </div>

                                                        <div className="flex justify-between items-end mb-2">
                                                            <span className="text-xs font-bold text-slate-400">{currentContent.labels.level}</span>
                                                            <div className="text-sm font-bold text-slate-800">{currentRole.axes.interaction}</div>
                                                        </div>

                                                        <div className="h-2 w-full bg-slate-100 rounded-full overflow-hidden">
                                                            <div className={`h-full bg-gradient-to-r ${currentRole.gradient} transition-all duration-500`} style={{
                                                                width: currentRole.axes.interaction.includes('Forte') || currentRole.axes.interaction.includes('High') ? '90%' : currentRole.axes.interaction.includes('Moyenne') || currentRole.axes.interaction.includes('Medium') ? '50%' : '15%'
                                                            }}></div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        {/* Right Col: Behaviors */}
                                        <div className="md:col-span-5 flex flex-col gap-4">
                                            <div className="bg-white rounded-2xl p-6 border border-slate-200 shadow-md">
                                                <h3 className="font-bold text-slate-900 mb-4 flex items-center gap-2 text-sm uppercase tracking-wide">
                                                    <Target className="w-4 h-4 text-slate-400" />
                                                    {currentContent.labels.behaviors}
                                                </h3>
                                                <ul className="space-y-3">
                                                    {currentRole.behaviors.map((b, i) => (
                                                        <li key={i} className="flex items-start text-slate-700 text-sm">
                                                            <span className={`w-1.5 h-1.5 rounded-full mt-1.5 mr-3 flex-shrink-0 bg-gradient-to-r ${currentRole.gradient}`}></span>
                                                            {b}
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>

                                            <div className={`rounded-2xl p-6 border ${currentRole.bgCls} ${currentRole.borderCls}`}>
                                                <h3 className={`font-bold ${currentRole.colorCls} mb-2 flex items-center gap-2 text-sm uppercase tracking-wide`}>
                                                    <Info className="w-4 h-4" />
                                                    {currentContent.labels.when}
                                                </h3>
                                                <p className="text-slate-800 leading-relaxed italic text-sm">
                                                    {currentRole.when}
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* CHALLENGE TAB */}
                        {activeTab === 'challenge' && (
                            <div className="p-8 md:p-12 h-full flex flex-col justify-center animate-in">
                                {!quizFinished ? (
                                    <div className="max-w-4xl mx-auto w-full">
                                        <div className="flex items-center gap-4 mb-8">
                                            <div className="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
                                                <div className="h-full bg-slate-900 transition-all duration-300" style={{ width: `${((currentScenarioIndex + 1) / scenarios.length) * 100}%` }}></div>
                                            </div>
                                            <span className="text-sm font-bold text-slate-400">{currentScenarioIndex + 1}/{scenarios.length}</span>
                                        </div>

                                        <div className="bg-slate-900 text-white p-8 rounded-3xl shadow-xl mb-10 text-center relative overflow-hidden">
                                            <Quote className="w-10 h-10 text-slate-700 absolute top-4 left-4 opacity-50" />
                                            <h3 className="text-xl md:text-2xl font-bold leading-normal relative z-10">"{scenarios[currentScenarioIndex].text}"</h3>
                                        </div>

                                        {!showResult ? (
                                            <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-2">
                                                {roles.map((role) => (
                                                    <button
                                                        key={role.id}
                                                        onClick={() => handleAnswer(role.id)}
                                                        className={`flex flex-col items-center justify-start p-2 py-4 rounded-xl border border-slate-100 bg-white hover:border-slate-400 hover:shadow-md transition-all group h-28`}
                                                    >
                                                        <div className={`p-2 rounded-full bg-slate-50 mb-2 group-hover:scale-110 transition-transform ${role.colorCls}`}>
                                                            {React.cloneElement(role.icon, { className: "w-5 h-5" })}
                                                        </div>
                                                        <span className="font-bold text-[10px] uppercase tracking-wide text-slate-600 group-hover:text-slate-900 text-center leading-tight">
                                                            {role.title.split(' ')[0]}<br/>{role.title.split(' ')[1]}
                                                        </span>
                                                    </button>
                                                ))}
                                            </div>
                                        ) : (
                                            <div className={`p-8 rounded-3xl text-center animate-in border-2 ${
                                                selectedAnswer === scenarios[currentScenarioIndex].correct ? 'bg-emerald-50 border-emerald-100' : 'bg-rose-50 border-rose-100'
                                            }`}>
                                                <h3 className={`text-2xl font-black mb-3 ${selectedAnswer === scenarios[currentScenarioIndex].correct ? 'text-emerald-800' : 'text-rose-800'}`}>
                                                    {selectedAnswer === scenarios[currentScenarioIndex].correct ? currentContent.labels.correct : currentContent.labels.incorrect}
                                                </h3>
                                                <p className="text-slate-700 mb-8 max-w-xl mx-auto text-lg leading-relaxed">
                                                    {scenarios[currentScenarioIndex].explanation}
                                                </p>
                                                <button onClick={nextScenario} className="bg-slate-900 text-white px-10 py-4 rounded-xl font-bold hover:bg-slate-800 transition-all shadow-lg flex items-center mx-auto gap-2">
                                                    {currentContent.labels.next} <ArrowRight className="w-5 h-5" />
                                                </button>
                                            </div>
                                        )}
                                    </div>
                                ) : (
                                    <div className="text-center py-10">
                                        <Trophy className="w-24 h-24 text-yellow-500 mx-auto mb-6" />
                                        <h2 className="text-4xl font-black text-slate-900 mb-4">{currentContent.labels.score} {score} / {scenarios.length}</h2>
                                        <button onClick={resetQuiz} className="inline-flex items-center px-8 py-3 rounded-xl border-2 border-slate-200 font-bold hover:border-slate-900 transition-all">
                                            <RefreshCcw className="mr-2 w-4 h-4" /> {currentContent.labels.restart}
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                    
                    <footer className="mt-8 text-slate-400 text-[10px] text-center font-medium uppercase tracking-widest opacity-60 max-w-lg">
                        {currentContent.labels.footer}
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FacilitrainingExplorer />);
    </script>
</body>
</html>
